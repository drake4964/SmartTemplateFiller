---
title: SmartTemplateFiller - Component Diagram
---
classDiagram
    class MainApp {
        +start(Stage primaryStage)
        +main(String[] args)
    }
    
    class MainController {
        -Stage stage
        -TableView tableView
        +setStage(Stage stage)
        +handleLoadTxt(ActionEvent event)
        +handleTeachMode(ActionEvent event)
        +handleExportToExcel(ActionEvent event)
        +handleRunningMode(ActionEvent event)
        -showAlert(String title, String message)
        -showInfo(String title, String message)
    }
    
    class TeachModeController {
        -ComboBox columnComboBox
        -TextField cellField
        -ComboBox directionComboBox
        -ComboBox rowPatternComboBox
        -TextField manualRowField
        -TextField titleField
        -ListView mappingListView
        -TableView excelPreviewTable
        -Label previewStatusLabel
        -TableView tableView
        -List colMappings
        +setTableView(TableView tableView)
        +initialize()
        +handleAddMapping()
        +handleDeleteSelected()
        +handleMoveUp()
        +handleMoveDown()
        +handleClearAll()
        +handleSaveMapping()
        +handleLoadMapping()
        -setupDragAndDrop()
        -updateMappingListView()
        -updateExcelPreview()
        -clearInputFields()
        -showValidationError(String message)
        -showInfo(String message)
    }
    
    class RunningModeController {
        -TextField mappingFileField
        -TextField watchFolderField
        -TextField outputFolderField
        -TextField filePatternField
        -TextField intervalField
        -TextArea logArea
        -Button startButton
        -Button stopButton
        -Label statusLabel
        -Stage stage
        -RunningModeConfig config
        -FolderWatcher watcher
        +initialize(URL, ResourceBundle)
        +setStage(Stage stage)
        +handleBrowseMapping(ActionEvent)
        +handleBrowseWatchFolder(ActionEvent)
        +handleBrowseOutputFolder(ActionEvent)
        +handleStart(ActionEvent)
        +handleStop(ActionEvent)
        +handleOpenOutputFolder(ActionEvent)
        +handleClose(ActionEvent)
        -loadConfigToUI()
        -saveConfig()
        -validateConfig()
        -setConfigFieldsDisabled(boolean)
        -logMessage(String)
        -showAlert(String, String)
    }
    
    class FolderWatcher {
        -Path watchFolder
        -Set fileExtensions
        -File mappingFile
        -Path outputFolder
        -int intervalSeconds
        -Consumer logCallback
        -ScheduledExecutorService scheduler
        -boolean running
        -Set processingFiles
        +FolderWatcher(RunningModeConfig, Consumer)
        +start()
        +stop()
        +isRunning()
        -scanFolder()
        -processFile(File)
        -log(String)
    }
    
    class RunningModeConfig {
        -String mappingFile
        -String watchFolder
        -String outputFolder
        -String filePattern
        -int intervalSeconds
        +getMappingFile()
        +setMappingFile(String)
        +getWatchFolder()
        +setWatchFolder(String)
        +getOutputFolder()
        +setOutputFolder(String)
        +getFilePattern()
        +setFilePattern(String)
        +getIntervalSeconds()
        +setIntervalSeconds(int)
        +save()
        +load()$
    }
    
    class TxtParser {
        +parseFile(File file)$ List~List~String~~
        +parseFixedColumnTable(File file)$ List~List~String~~
        -loadColumnConfig()$ Map~String,Integer~
        +parseMultiLineGroupedBlock(File file)$ List~List~String~~
        +parseFlatTable(File file)$ List~List~String~~
        +generateIndexes(int totalRows, String patternType, int startIndex)$ List~Integer~
    }
    
    class ExcelWriter {
        +writeAdvancedMappedFile(File txtFile, File mappingFile, File outputFile)$
    }
    
    class FileChooserBuilder {
        -Stage stage
        -FileChooser chooser
        -File lastDirectory$
        +FileChooserBuilder(Stage stage)
        +withTitle(String title) FileChooserBuilder
        +withExtension(String label, String[] extensions) FileChooserBuilder
        +withInitialDirectory(File directory) FileChooserBuilder
        +open() File
        +save(String defaultFileName) File
        -updateLastDirectory(File file)
        +resetLastDirectory()$
    }
    
    class MappingData {
        +int sourceCol
        +int startRow
        +int startCol
        +String direction
        +String title
        +List values
    }
    
    MainApp --> MainController : loads
    MainController --> TxtParser : uses
    MainController --> TeachModeController : opens
    MainController --> RunningModeController : opens
    MainController --> ExcelWriter : uses
    MainController --> FileChooserBuilder : uses
    TeachModeController --> TxtParser : uses generateIndexes
    TeachModeController --> MappingData : creates
    TeachModeController --> FileChooserBuilder : uses
    ExcelWriter --> TxtParser : uses parseFile
    RunningModeController --> FolderWatcher : creates
    RunningModeController --> RunningModeConfig : uses
    FolderWatcher --> ExcelWriter : uses
    FolderWatcher --> RunningModeConfig : reads
